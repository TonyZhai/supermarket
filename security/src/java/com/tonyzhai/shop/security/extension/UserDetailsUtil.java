package com.tonyzhai.shop.security.extension;import com.tonyzhai.shop.domain.security.User;import org.springframework.security.core.context.SecurityContext;import org.springframework.security.core.context.SecurityContextHolder;/** * User util * * @author Tony Zhai * @since 13-2-24 PM5:01 */public class UserDetailsUtil {    /**     * get current login user     *     * @return current user     */    public static User getCurrentUser() {        SecurityContext context = SecurityContextHolder.getContext();        if(context != null && context.getAuthentication() != null) {            org.springframework.security.core.userdetails.UserDetails userDetails = check(context.getAuthentication().getPrincipal());            if(userDetails != null) {//                return userDetails.getUser();                return new User(userDetails.getUsername(), userDetails.getPassword());            }        }        return null;    }    private static org.springframework.security.core.userdetails.UserDetails check(Object obj) {        if(obj != null && !obj.toString().equals("anonymousUser")) {            return (org.springframework.security.core.userdetails.UserDetails) obj;        }        return null;    }}